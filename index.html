<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Al√©m do Bolo ‚Äì Sistema Buffet</title>

<style>
:root{--p:#0f172a;--d:#10b981;--b:#e2e8f0}
body{margin:0;font-family:Segoe UI,sans-serif;display:flex;background:#f8fafc}
nav{width:300px;background:var(--p);color:#fff;height:100vh;position:fixed;padding:16px;overflow:auto}
nav h2{color:var(--d)}
.btn-menu{width:100%;padding:9px;margin-bottom:6px;border:0;border-radius:6px;background:#1e293b;color:#fff;cursor:pointer}
.btn-menu:hover{background:rgba(16,185,129,.2)}
.label{font-size:.7rem;color:#94a3b8;margin:12px 0 6px}
main{margin-left:320px;padding:24px;width:100%}
.card{background:#fff;padding:18px;border-radius:10px;border:1px solid var(--b);margin-bottom:16px}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid var(--b)}
.btn{padding:6px 10px;border-radius:6px;border:1px solid var(--b);cursor:pointer}
.primary{background:var(--d);color:#fff;border:none}
.alert{color:#dc2626;font-weight:600}
input,select{width:100%;padding:6px;margin-bottom:6px}
.hidden{display:none}
.badge{padding:3px 8px;border-radius:10px;font-size:.75rem}
.pendente{background:#fde68a}
.ativo{background:#86efac}
.finalizado{background:#cbd5f5}
</style>
</head>

<body>

<nav id="menu" class="hidden">
<h2>BUFFET PRO</h2>

<div class="label">Estoque</div>
<button class="btn-menu staff-only" onclick="renderCategoria('C√¢mara')">üì¶ C√¢mara</button>
<button class="btn-menu staff-only" onclick="renderCategoria('Freezer')">‚ùÑÔ∏è Freezer</button>
<button class="btn-menu staff-only" onclick="renderCategoria('Material')">üçΩ Material</button>

<div class="label">Eventos</div>
<button class="btn-menu staff-only" onclick="renderEventos()">üìÜ Eventos</button>

<div class="label">Cliente</div>
<button class="btn-menu cliente-only" onclick="novoPedido()">üìù Novo Pedido</button>
<button class="btn-menu cliente-only" onclick="meusPedidos()">üìã Meus Pedidos</button>

<div class="label">Admin</div>
<button class="btn-menu admin-only" onclick="renderUsuarios()">üë• Usu√°rios</button>
<button class="btn-menu admin-only" onclick="exportar()">‚¨á Exportar Invent√°rio</button>

<button class="btn-menu" onclick="logout()">üö™ Sair</button>
</nav>

<main id="app"></main>

<script>
/* ================= USU√ÅRIOS ================= */
let usuarios = JSON.parse(localStorage.getItem('usuarios')) || [
 {user:'admin',pass:'123',role:'admin'},
 {user:'staff',pass:'123',role:'staff'},
 {user:'cliente',pass:'123',role:'cliente'}
];
let usuarioAtual = JSON.parse(localStorage.getItem('usuarioAtual')) || null;

/* ================= DADOS ================= */
let estoque = JSON.parse(localStorage.getItem('estoque')) || [
 {id:1,nome:'Carne',cat:'C√¢mara',qtd:20,min:10},
 {id:2,nome:'Polpa',cat:'Freezer',qtd:30,min:15},
 {id:3,nome:'Pratos',cat:'Material',qtd:100,min:50}
];

let eventos = JSON.parse(localStorage.getItem('eventos')) || [];
let pedidos = JSON.parse(localStorage.getItem('pedidos')) || [];

/* ================= LOGIN ================= */
function renderLogin(){
 app.innerHTML=`
 <div class="card" style="max-width:400px">
 <h3>Login</h3>
 <input id="lu" placeholder="Usu√°rio">
 <input id="lp" type="password" placeholder="Senha">
 <button class="btn primary" onclick="login()">Entrar</button>
 </div>`;
}
renderLogin();

function login(){
 let u = usuarios.find(x=>x.user===lu.value && x.pass===lp.value);
 if(!u){ alert('Login inv√°lido'); return; }
 usuarioAtual=u;
 localStorage.setItem('usuarioAtual',JSON.stringify(u));
 aplicarPermissoes();
}
function logout(){
 localStorage.clear();
 location.reload();
}

/* ================= PERMISS√ïES ================= */
function aplicarPermissoes(){
 menu.classList.remove('hidden');
 document.querySelectorAll('.admin-only')
  .forEach(e=>e.style.display=usuarioAtual.role==='admin'?'block':'none');
 document.querySelectorAll('.staff-only')
  .forEach(e=>e.style.display=(usuarioAtual.role!=='cliente')?'block':'none');
 document.querySelectorAll('.cliente-only')
  .forEach(e=>e.style.display=usuarioAtual.role==='cliente'?'block':'none');
 renderHome();
}

/* ================= HOME ================= */
function renderHome(){
 app.innerHTML=`
 <div class="card">
 <h2>Bem-vindo ${usuarioAtual.user}</h2>
 <p>Perfil: <b>${usuarioAtual.role}</b></p>
 </div>`;
}

/* ================= ESTOQUE ================= */
function renderCategoria(cat){
 let html=`<div class="card"><h3>${cat}</h3><table>
 <tr><th>Item</th><th>Qtd</th><th>A√ß√µes</th></tr>`;
 estoque.filter(i=>i.cat===cat).forEach(i=>{
  html+=`<tr>
  <td>${i.nome}</td>
  <td class="${i.qtd<i.min?'alert':''}">${i.qtd}</td>
  <td>
   <button class="btn" onclick="ajustar(${i.id},1)">+</button>
   <button class="btn" onclick="ajustar(${i.id},-1)">-</button>
  </td></tr>`;
 });
 html+=`</table>
 <h4>‚ûï Agregar item</h4>
 <input id="n" placeholder="Nome">
 <input id="q" type="number" placeholder="Qtd">
 <input id="m" type="number" placeholder="Min">
 <button class="btn primary" onclick="agregar('${cat}')">Agregar</button>
 </div>`;
 app.innerHTML=html;
}
function ajustar(id,v){
 let i=estoque.find(x=>x.id===id);
 if(i)i.qtd=Math.max(0,i.qtd+v);
 save();
}
function agregar(cat){
 estoque.push({id:Date.now(),nome:n.value,cat,qtd:+q.value,min:+m.value});
 save();renderCategoria(cat);
}

/* ================= CLIENTE ‚Äì PEDIDOS ================= */
function novoPedido(){
 app.innerHTML=`
 <div class="card">
 <h3>Novo Pedido</h3>
 <select id="tipo">
  <option>Caf√© da manh√£</option>
  <option>Coffee break</option>
  <option>Almo√ßo</option>
  <option>Jantar</option>
  <option>Coquetel</option>
 </select>
 <button class="btn primary" onclick="criarPedido()">Enviar Pedido</button>
 </div>`;
}
function criarPedido(){
 pedidos.push({
  id:Date.now(),
  cliente:usuarioAtual.user,
  tipo:tipo.value,
  status:'pendente',
  data:new Date().toISOString()
 });
 save();
 meusPedidos();
}
function meusPedidos(){
 let html=`<div class="card"><h3>Meus Pedidos</h3><table>
 <tr><th>Data</th><th>Tipo</th><th>Status</th></tr>`;
 pedidos.filter(p=>p.cliente===usuarioAtual.user)
 .forEach(p=>{
  html+=`<tr>
  <td>${new Date(p.data).toLocaleString()}</td>
  <td>${p.tipo}</td>
  <td><span class="badge ${p.status}">${p.status}</span></td>
  </tr>`;
 });
 html+='</table></div>';
 app.innerHTML=html;
}

/* ================= EVENTOS (STAFF) ================= */
function renderEventos(){
 let html=`<div class="card"><h3>Eventos</h3><table>
 <tr><th>Cliente</th><th>Tipo</th><th>Status</th><th>A√ß√£o</th></tr>`;
 pedidos.forEach(p=>{
  html+=`<tr>
  <td>${p.cliente}</td>
  <td>${p.tipo}</td>
  <td>${p.status}</td>
  <td>
   ${p.status==='pendente'
    ?`<button class="btn" onclick="ativar(${p.id})">Ativar</button>`:''}
  </td></tr>`;
 });
 html+='</table></div>';
 app.innerHTML=html;
}
function ativar(id){
 let p=pedidos.find(x=>x.id===id);
 p.status='ativo';
 save();renderEventos();
}

/* ================= USU√ÅRIOS ================= */
function renderUsuarios(){
 let html=`<div class="card"><h3>Usu√°rios</h3><table>
 <tr><th>User</th><th>Role</th></tr>`;
 usuarios.forEach(u=>html+=`<tr><td>${u.user}</td><td>${u.role}</td></tr>`);
 html+=`</table>
 <input id="nu" placeholder="Usu√°rio">
 <input id="np" placeholder="Senha">
 <select id="nr"><option>admin</option><option>staff</option><option>cliente</option></select>
 <button class="btn primary" onclick="addUsuario()">Agregar</button>
 </div>`;
 app.innerHTML=html;
}
function addUsuario(){
 usuarios.push({user:nu.value,pass:np.value,role:nr.value});
 localStorage.setItem('usuarios',JSON.stringify(usuarios));
 renderUsuarios();
}

/* ================= EXPORT ================= */
function exportar(){
 let csv='Item,Categoria,Quantidade\n';
 estoque.forEach(i=>csv+=`${i.nome},${i.cat},${i.qtd}\n`);
 let a=document.createElement('a');
 a.href=URL.createObjectURL(new Blob([csv]));
 a.download='inventario.csv';
 a.click();
}

/* ================= SAVE ================= */
function save(){
 localStorage.setItem('estoque',JSON.stringify(estoque));
 localStorage.setItem('pedidos',JSON.stringify(pedidos));
 localStorage.setItem('eventos',JSON.stringify(eventos));
}
</script>
</body>
</html>



