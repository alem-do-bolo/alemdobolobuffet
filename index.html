<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Gest√£o Buffet ‚Äì Al√©m do Bolo</title>

<style>
:root{--p:#0f172a;--d:#10b981;--b:#e2e8f0}
body{margin:0;font-family:Segoe UI,sans-serif;display:flex;background:#f8fafc}
nav{width:300px;background:var(--p);color:#fff;height:100vh;position:fixed;padding:16px;overflow:auto}
nav h2{color:var(--d)}
.btn-menu{width:100%;padding:9px;margin-bottom:6px;border:0;border-radius:6px;background:#1e293b;color:#fff;cursor:pointer}
.btn-menu:hover{background:rgba(16,185,129,.2)}
.label{font-size:.7rem;color:#94a3b8;margin:12px 0 6px}
main{margin-left:320px;padding:24px;width:100%}
.card{background:#fff;padding:18px;border-radius:10px;border:1px solid var(--b)}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{padding:8px;border-bottom:1px solid var(--b)}
.btn{padding:6px 10px;border-radius:6px;border:1px solid var(--b);cursor:pointer}
.primary{background:var(--d);color:#fff;border:none}
.alert{color:#dc2626;font-weight:600}
input,select{width:100%;padding:6px;margin-bottom:6px}
.hidden{display:none}
</style>
</head>

<body>

<nav>
<h2>BUFFET PRO</h2>

<div class="label">Login</div>
<button class="btn-menu" onclick="login('admin')">üëë Admin</button>
<button class="btn-menu" onclick="login('staff')">üë∑ Staff</button>

<div class="label">Estoque</div>
<button class="btn-menu" onclick="renderCategoria('C√¢mara')">üì¶ C√¢mara</button>
<button class="btn-menu" onclick="renderCategoria('Freezer')">‚ùÑÔ∏è Freezer</button>
<button class="btn-menu" onclick="renderCategoria('Material')">üçΩ Material</button>
<button class="btn-menu" onclick="renderCategoria('Equipamento')">‚ö° Equipamentos</button>

<div class="label">Eventos</div>
<button class="btn-menu" onclick="renderProposta()">‚ûï Nova Proposta</button>
<button class="btn-menu" onclick="renderEventos()">üìÜ Eventos</button>

<div class="label admin-only">Admin</div>
<button class="btn-menu admin-only" onclick="renderStaff()">üë• Staff</button>
<button class="btn-menu admin-only" onclick="exportar()">‚¨á Exportar Invent√°rio</button>
</nav>

<main id="app"></main>

<script>
let role=localStorage.getItem('role')||'staff';
let estoque=JSON.parse(localStorage.getItem('estoque'))||[];
let eventos=JSON.parse(localStorage.getItem('eventos'))||[];
let staff=JSON.parse(localStorage.getItem('staff'))||[];

login(role);

/* ===== LOGIN ===== */
function login(r){
 role=r;localStorage.setItem('role',r);
 document.querySelectorAll('.admin-only').forEach(b=>{
  b.style.display=r==='admin'?'block':'none';
 });
 renderHome();
}

/* ===== HOME ===== */
function renderHome(){
 app.innerHTML=`<div class="card"><h2>Gest√£o de Buffet</h2>
 <p>Perfil atual: <b>${role}</b></p></div>`;
}

/* ===== ESTOQUE ===== */
function renderCategoria(cat){
 let html=`<div class="card"><h3>${cat}</h3>
 <table><tr><th>Item</th><th>Qtd</th><th>A√ß√µes</th></tr>`;
 estoque.filter(i=>i.cat===cat).forEach(i=>{
  html+=`<tr>
   <td>${i.nome}</td>
   <td class="${i.qtd<i.min?'alert':''}">${i.qtd}</td>
   <td>
    <button class="btn" onclick="ajustar(${i.id},1)">+</button>
    <button class="btn" onclick="ajustar(${i.id},-1)">-</button>
   </td></tr>`;
 });
 html+=`</table>
 <h4>‚ûï Agregar √≠tem</h4>
 <input id="n"><input id="q" type="number"><input id="m" type="number">
 <button class="btn primary" onclick="agregar('${cat}')">Agregar</button>
 </div>`;
 app.innerHTML=html;
}
function ajustar(id,v){
 let i=estoque.find(x=>x.id===id);
 if(i){i.qtd=Math.max(0,i.qtd+v);}
 save();
}
function agregar(cat){
 estoque.push({id:Date.now(),nome:n.value,cat:cat,qtd:+q.value||0,min:+m.value||0});
 save();renderCategoria(cat);
}

/* ===== PROPOSTA / EVENTO ===== */
function renderProposta(){
 app.innerHTML=`<div class="card">
 <h3>Nueva Propuesta</h3>
 <button class="btn primary" onclick="crearEvento()">Confirmar Evento</button>
 </div>`;
}
function crearEvento(){
 let items=estoque.map(i=>({id:i.id,nome:i.nome,qty:1}));
 items.forEach(it=>{
  let p=estoque.find(x=>x.id===it.id);
  if(p)p.qtd=Math.max(0,p.qtd-it.qty);
 });
 eventos.push({id:Date.now(),fecha:new Date().toISOString(),items:items,status:'activo'});
 save();
 renderEventos();
}

/* ===== EVENTOS ===== */
function renderEventos(){
 let html=`<div class="card"><h3>Eventos</h3><table>
 <tr><th>Fecha</th><th>Status</th><th>Ver</th></tr>`;
 eventos.forEach(e=>{
  html+=`<tr>
   <td>${new Date(e.fecha).toLocaleString()}</td>
   <td>${e.status}</td>
   <td><button class="btn" onclick="verEvento(${e.id})">Abrir</button></td>
  </tr>`;
 });
 html+=`</table></div>`;
 app.innerHTML=html;
}
function verEvento(id){
 let e=eventos.find(x=>x.id===id);
 let html=`<div class="card"><h3>Evento</h3>
 <p>${new Date(e.fecha).toLocaleString()}</p>
 <ul>`;
 e.items.forEach(i=>html+=`<li>${i.nome} ‚Äì ${i.qty}</li>`);
 html+=`</ul>`;
 if(e.status==='activo'){
  html+=`<button class="btn primary" onclick="finalizar(${id})">Finalizar</button>`;
 }
 html+=`</div>`;
 app.innerHTML=html;
}
function finalizar(id){
 let e=eventos.find(x=>x.id===id);
 e.items.forEach(it=>{
  let p=estoque.find(x=>x.id===it.id);
  if(p)p.qtd+=it.qty;
 });
 e.status='finalizado';
 save();renderEventos();
}

/* ===== STAFF ===== */
function renderStaff(){
 let html=`<div class="card"><h3>Staff</h3>
 <ul>${staff.map(s=>`<li>${s}</li>`).join('')}</ul>
 <input id="s"><button class="btn primary" onclick="addStaff()">Add Staff</button>
 </div>`;
 app.innerHTML=html;
}
function addStaff(){
 staff.push(s.value);localStorage.setItem('staff',JSON.stringify(staff));
 renderStaff();
}

/* ===== EXPORT ===== */
function exportar(){
 let csv='Item,Categoria,Quantidade,Minimo\n';
 estoque.forEach(i=>csv+=`${i.nome},${i.cat},${i.qtd},${i.min}\n`);
 let a=document.createElement('a');
 a.href=URL.createObjectURL(new Blob([csv]));
 a.download='inventario.csv';
 a.click();
}

function save(){
 localStorage.setItem('estoque',JSON.stringify(estoque));
 localStorage.setItem('eventos',JSON.stringify(eventos));
}
</script>
</body>
</html>


